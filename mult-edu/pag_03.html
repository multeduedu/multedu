<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./css/style.css">
  <title>Jogo da Subtração Colorida (-) (CDU)</title>
  <link href="https://fonts.googleapis.com/css2?family=OpenDyslexic:wght@400;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'OpenDyslexic', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      background-color: #f0f8ff;
      padding: 20px;
      box-sizing: border-box;
      letter-spacing: 0.05em;
      word-spacing: 0.1em;
    }

    h1 {
      color: #333;
      margin-bottom: 15px;
      font-weight: 700;
      text-align: center;
      /* Centraliza o título */
    }

    p {
      color: #555;
      margin-bottom: 30px;
      text-align: center;
      max-width: 600px;
      /* Limita a largura do parágrafo */
    }

    .game-container {
      display: flex;
      justify-content: center;
      /* Remove flex-wrap se sempre forem apenas 2, mas manter não atrapalha */
      flex-wrap: wrap;
      align-items: center;
      margin-bottom: 30px;
      width: 100%;
      /* Reduz max-width pois são menos caixas */
      max-width: 600px;
      /* Ajustado */
    }

    .number-box {
      border: 2px solid;
      border-radius: 10px;
      padding: 15px;
      text-align: center;
      /* Reduz min-width se necessário para caber 2 lado a lado em telas maiores */
      min-width: 250px;
      /* Ajustado */
      background-color: white;
      box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      /* Ajusta margem para espaçar 2 caixas lado a lado */
      margin: 10px;
      /* Ajustado */
      box-sizing: border-box;
    }

    /* Aplicando cores específicas pela ordem de aparição dos .number-box */
    /* Apenas as duas primeiras regras são relevantes agora */
    .game-container>.number-box:nth-of-type(1) {
      border-color: #ff6347;
      /* Tomato */
    }

    .game-container>.number-box:nth-of-type(2) {
      border-color: #ffd700;
      /* Gold */
    }

    /* As regras para 3, 4, 5 não terão efeito, mas podem ser mantidas ou removidas */
    .game-container>.number-box:nth-of-type(3) {
      border-color: #90ee90;
      /* LightGreen */
    }

    .game-container>.number-box:nth-of-type(4) {
      border-color: #add8e6;
      /* LightBlue */
    }

    .game-container>.number-box:nth-of-type(5) {
      border-color: #dda0dd;
      /* Plum */
    }


    .selectors-wrapper {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 15px;
      flex-wrap: wrap;
      width: 100%;
    }

    .selector-group {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .selector-group label {
      margin-bottom: 5px;
      font-weight: bold;
      color: #555;
      font-size: 0.9em;
    }

    /* Estilo para as caixas de seleção (select) */
    .selector-group select {
      font-family: 'OpenDyslexic', sans-serif;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 1em;
      cursor: pointer;
      min-width: 45px;
      letter-spacing: normal;
      word-spacing: normal;
    }


    /* Estilo para o símbolo de MENOS (-) */
    .minus-symbol {
      font-size: 2.5em;
      font-weight: 700;
      color: #444;
      /* Ajusta margem para espaçar o '-' entre 2 caixas */
      margin: 10px;
      /* Ajustado */
    }

    /* Container para a caixa de input do resultado do usuário */
    .answer-input-container {
      margin-top: 20px;
      margin-bottom: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      width: 90%;
      max-width: 300px;
    }

    .answer-input-container label {
      font-size: 1.1em;
      font-weight: 700;
      color: #333;
    }

    /* Estilo para a caixa de input do resultado do usuário */
    .answer-input-container input[type="number"] {
      font-family: 'OpenDyslexic', sans-serif;
      padding: 10px;
      border: 2px solid #007bff;
      border-radius: 5px;
      font-size: 1.3em;
      width: 100%;
      text-align: center;
      -moz-appearance: textfield;
      letter-spacing: normal;
      word-spacing: normal;
    }

    .answer-input-container input[type="number"]::-webkit-outer-spin-button,
    .answer-input-container input[type="number"]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }


    .button-container {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }

    .calculate-button,
    .reset-button {
      font-family: 'OpenDyslexic', sans-serif;
      padding: 12px 25px;
      font-size: 1.2em;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      font-weight: 700;
    }

    .calculate-button {
      background-color: #4CAF50;
    }

    .calculate-button:hover {
      background-color: #45a049;
    }

    .reset-button {
      background-color: #f44336;
    }

    .reset-button:hover {
      background-color: #d32f2f;
    }

    /* Área para a representação visual */
    .visual-representation {
      width: 100%;
      min-height: 80px;
      border-top: 1px dashed #ccc;
      padding-top: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      text-align: left;
      box-sizing: border-box;
    }

    .visual-representation>div {
      display: flex;
      flex-wrap: wrap;
      gap: 3px;
      width: 100%;
      justify-content: center;
    }

    .visual-representation span {
      font-weight: 700;
      color: #555;
      font-size: 0.85em;
      width: 100%;
      text-align: left;
      margin-bottom: 2px;
    }

    /* Estilos para os blocos placeholders */
    .hundred-block {
      width: 30px;
      height: 30px;
      background-color: #ff6347;
      border: 1px solid #d4533b;
    }

    .ten-block {
      width: 25px;
      height: 8px;
      background-color: #ffd700;
      border: 1px solid #d4b800;
    }

    .unit-block {
      width: 8px;
      height: 8px;
      background-color: #90ee90;
      border: 1px solid #78d178;
    }


    #result {
      font-family: 'OpenDyslexic', sans-serif;
      margin-top: 20px;
      font-size: 1.5em;
      font-weight: 700;
      color: #333;
      background-color: #fffacd;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #eee8aa;
      min-height: 50px;
      text-align: center;
      box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
      width: 90%;
      max-width: 600px;
      white-space: pre-wrap;
      letter-spacing: 0.05em;
      word-spacing: 0.1em;
    }

    .correct {
      color: green;
      background-color: #e8f5e9;
      border-color: #a5d6a7;
    }

    .incorrect {
      color: red;
      background-color: #ffebee;
      border-color: #ef9a9a;
    }


    /* Estilos responsivos */
    @media (max-width: 768px) {

      /* Ajusta ponto de quebra para telas menores para 2 caixas */
      .game-container {
        flex-direction: column;
        /* Empilha as caixas em telas menores */
        max-width: 95%;
      }

      .number-box {
        min-width: 90%;
        /* Ocupa quase toda a largura */
        margin: 10px 0;
        /* Espaçamento vertical */
        padding: 10px;
      }

      .minus-symbol {
        display: none;
        /* Esconde o '-' quando empilhado */
      }

      body {
        letter-spacing: 0.03em;
        word-spacing: 0.08em;
      }

      .selectors-wrapper {
        gap: 10px;
        margin-bottom: 10px;
        justify-content: center;
      }

      .selector-group label {
        font-size: 0.8em;
      }

      .selector-group select {
        min-width: 40px;
        padding: 6px;
        font-size: 0.9em;
      }

      .answer-input-container {
        max-width: 90%;
        gap: 8px;
      }

      .answer-input-container label {
        font-size: 1em;
      }

      .answer-input-container input[type="number"] {
        padding: 8px;
        font-size: 1.2em;
      }

      h1 {
        font-size: 1.5em;
      }

      #result {
        font-size: 1.2em;
        letter-spacing: normal;
        word-spacing: normal;
      }

      .button-container {
        gap: 10px;
        flex-direction: column;
        align-items: center;
      }

      .calculate-button,
      .reset-button {
        width: 90%;
        max-width: 250px;
        padding: 10px 20px;
      }

      .visual-representation {
        min-height: 60px;
        padding-top: 8px;
      }

      .hundred-block {
        width: 25px;
        height: 25px;
      }

      .ten-block {
        width: 20px;
        height: 7px;
      }

      .unit-block {
        width: 7px;
        height: 7px;
      }

      .visual-representation span {
        font-size: 0.8em;
      }
    }

    /* Regra para telas maiores para garantir que fiquem lado a lado */
    @media (min-width: 769px) {
      .game-container {
        flex-direction: row;
        /* Mantém lado a lado */
        align-items: flex-start;
        /* Alinha no topo */
      }

      .number-box {
        margin: 10px;
        /* Espaçamento igual */
      }

      .minus-symbol {
        display: flex;
        /* Mostra o '-' */
        align-self: center;
        /* Centraliza verticalmente */
      }
    }
  </style>
</head>

<body>

  <header style="margin-bottom: 3rem;">
    <a href="./atividades.html">
      <button type="button" class="voltar-main" style="position: absolute; top: 2%; left: 2%;">← Voltar</button>
    </a>
  </header>

  <h1> Vamos Praticar Subtração ! </h1>
  <p>Escolha a centena, dezena e unidade para formar o primeiro número e o segundo número. O jogo irá subtrair o segundo
    número do primeiro. Digite o resultado no campo abaixo e clique em Verificar!</p>
  <div class="game-container" id="gameContainer">
  </div>

  <div class="answer-input-container">
    <label for="userAnswer">Seu resultado:</label> <input type="number" id="userAnswer" value="">
  </div>


  <div class="button-container">
    <button class="calculate-button" id="calculateButton">Verificar!</button>
    <button class="reset-button" id="resetButton">Resetar</button>
  </div>

  <div id="result">O resultado da subtração aparecerá aqui!</div>

  <script>
    const gameContainer = document.getElementById('gameContainer');
    const calculateButton = document.getElementById('calculateButton');
    const resetButton = document.getElementById('resetButton');
    const resultDiv = document.getElementById('result');
    const userAnswerInput = document.getElementById('userAnswer');

    const numberOfBoxes = 2; // ALTERADO: Agora apenas 2 caixas
    const initialResultText = 'O resultado da subtração aparecerá aqui!';

    // Função para criar um grupo de seletores (Centena, Dezena, Unidade)
    function createSelectorGroup(idPrefix, index, labelText, className) {
      const groupDiv = document.createElement('div');
      groupDiv.classList.add('selector-group');
      const label = document.createElement('label');
      label.htmlFor = `${idPrefix}-${index}`;
      label.textContent = labelText;

      const select = document.createElement('select');
      select.id = `${idPrefix}-${index}`;
      select.classList.add(className);

      for (let i = 0; i <= 9; i++) {
        const option = document.createElement('option');
        option.value = i;
        option.textContent = i;
        select.appendChild(option);
      }

      groupDiv.appendChild(label);
      groupDiv.appendChild(select);
      return groupDiv;
    }

    // Função para criar a área de representação visual dos blocos
    function createVisualRepresentationArea(index) {
      const visualArea = document.createElement('div');
      visualArea.classList.add('visual-representation');
      visualArea.id = `visual-area-${index}`;

      visualArea.innerHTML = `
                <span>Centenas:</span>
                <div class="hundreds-container"></div>
                <span>Dezenas:</span>
                <div class="tens-container"></div>
                <span>Unidades:</span>
                <div class="units-container"></div>
            `;

      return visualArea;
    }

    // Função para criar a caixa de número completa (seletores + visual)
    function createNumberBox(index) {
      const box = document.createElement('div');
      box.classList.add('number-box');
      box.id = `box-${index}`;

      const selectorsWrapper = document.createElement('div');
      selectorsWrapper.classList.add('selectors-wrapper');

      const hundredsGroup = createSelectorGroup('hundreds', index, 'Centena', 'hundreds-selector');
      const tensGroup = createSelectorGroup('tens', index, 'Dezena', 'tens-selector');
      const unitsGroup = createSelectorGroup('units', index, 'Unidade', 'units-selector');

      selectorsWrapper.appendChild(hundredsGroup);
      selectorsWrapper.appendChild(tensGroup);
      selectorsWrapper.appendChild(unitsGroup);

      const visualArea = createVisualRepresentationArea(index);

      box.appendChild(selectorsWrapper);
      box.appendChild(visualArea);

      return box;
    }

    // Função para atualizar a representação visual de uma caixa específica
    function updateVisualRepresentation(boxIndex) {
      const hundredsSelect = document.getElementById(`hundreds-${boxIndex}`);
      const tensSelect = document.getElementById(`tens-${boxIndex}`);
      const unitsSelect = document.getElementById(`units-${boxIndex}`);

      const hundredsValue = parseInt(hundredsSelect.value, 10);
      const tensValue = parseInt(tensSelect.value, 10);
      const unitsValue = parseInt(unitsSelect.value, 10);

      const hundredsContainer = document.querySelector(`#visual-area-${boxIndex} .hundreds-container`);
      const tensContainer = document.querySelector(`#visual-area-${boxIndex} .tens-container`);
      const unitsContainer = document.querySelector(`#visual-area-${boxIndex} .units-container`);

      hundredsContainer.innerHTML = '';
      tensContainer.innerHTML = '';
      unitsContainer.innerHTML = '';

      for (let i = 0; i < hundredsValue; i++) {
        const hundredBlock = document.createElement('div');
        hundredBlock.classList.add('hundred-block');
        hundredsContainer.appendChild(hundredBlock);
      }

      for (let i = 0; i < tensValue; i++) {
        const tenBlock = document.createElement('div');
        tenBlock.classList.add('ten-block');
        tensContainer.appendChild(tenBlock);
      }

      for (let i = 0; i < unitsValue; i++) {
        const unitBlock = document.createElement('div');
        unitBlock.classList.add('unit-block');
        unitsContainer.appendChild(unitBlock);
      }
    }


    // --- Inicialização do Jogo ---

    // Cria as 2 caixas E o símbolo '-' entre elas /* ALTERADO numberOfBoxes = 2 */
    for (let i = 0; i < numberOfBoxes; i++) {
      const numberBox = createNumberBox(i);
      gameContainer.appendChild(numberBox);

      updateVisualRepresentation(i); // Chamada inicial

      // Adiciona '-' APENAS entre a primeira e a segunda caixa (i=0)
      if (i < numberOfBoxes - 1) { // numberOfBoxes - 1 é 1 (2-1=1)
        const minusSign = document.createElement('div');
        minusSign.textContent = '-';
        minusSign.classList.add('minus-symbol');
        gameContainer.appendChild(minusSign);
      }
    }

    // Adiciona listeners para atualizar a representação visual quando os SELETORES mudam (apenas para as 2 caixas)
    for (let i = 0; i < numberOfBoxes; i++) { // numberOfBoxes = 2
      document.getElementById(`hundreds-${i}`).addEventListener('change', () => updateVisualRepresentation(i));
      document.getElementById(`tens-${i}`).addEventListener('change', () => updateVisualRepresentation(i));
      document.getElementById(`units-${i}`).addEventListener('change', () => updateVisualRepresentation(i));
    }


    // Evento de clique no botão para calcular e verificar a resposta do usuário - LÓGICA DE CÁLCULO ALTERADA PARA 2 NÚMEROS
    calculateButton.addEventListener('click', () => {
      let numbers = []; // Array para armazenar os 2 números formados

      for (let i = 0; i < numberOfBoxes; i++) { // numberOfBoxes = 2
        const hundredsSelect = document.getElementById(`hundreds-${i}`);
        const tensSelect = document.getElementById(`tens-${i}`);
        const unitsSelect = document.getElementById(`units-${i}`);

        const hundredsValue = parseInt(hundredsSelect.value, 10);
        const tensValue = parseInt(tensSelect.value, 10);
        const unitsValue = parseInt(unitsSelect.value, 10);

        const number = (hundredsValue * 100) + (tensValue * 10) + unitsValue;
        numbers.push(number); // Adiciona o número ao array
      }

      // Calcula o resultado da subtração: primeiro número MENOS o segundo número
      const totalResult = numbers[0] - numbers[1];


      // Monta a string da operação: Número 1 - Número 2 = Resultado
      let operationStr = `${String(numbers[0]).padStart(3, '0')} - ${String(numbers[1]).padStart(3, '0')} = ${totalResult}`; // ALTERADO


      // Obtém a resposta do usuário
      const userAnswerValue = parseInt(userAnswerInput.value) || 0;

      // Compara a resposta do usuário com o total correto
      let comparisonMessage = `\nSua resposta: ${userAnswerValue}\n`;
      let resultClass = '';

      if (userAnswerValue === totalResult) {
        comparisonMessage += "Parabéns! Sua resposta está CORRETA!";
        resultClass = 'correct';
      } else {
        comparisonMessage += `Que pena! Sua resposta está INCORRETA.\nO resultado correto é: ${totalResult}`;
        resultClass = 'incorrect';
      }

      // Mostra a string completa e o resultado da comparação
      resultDiv.textContent = operationStr + comparisonMessage;
      resultDiv.style.display = 'block';

      resultDiv.classList.remove('correct', 'incorrect');
      resultDiv.classList.add(resultClass);
    });

    // Função para resetar os seletores CDU, o input de resposta do usuário e o resultado
    function resetGame() {
      // Reseta todos os seletores (select) CDU para 0 (apenas os das 2 caixas)
      const cduSelects = document.querySelectorAll('.selector-group select');
      cduSelects.forEach(select => {
        select.value = '0';
      });

      // Atualiza a representação visual de todas as caixas após o reset dos seletores CDU (apenas as 2)
      for (let i = 0; i < numberOfBoxes; i++) { // numberOfBoxes = 2
        updateVisualRepresentation(i);
      }

      // Limpa o input de resposta do usuário
      userAnswerInput.value = '';

      // Limpa o resultado e remove as classes de estilo
      resultDiv.textContent = initialResultText;
      resultDiv.classList.remove('correct', 'incorrect');
      resultDiv.style.display = 'block';
    }

    // Evento de clique no botão para resetar
    resetButton.addEventListener('click', resetGame);


    // Mostra o texto inicial no resultado ao carregar a página e limpa o input de resposta
    resultDiv.textContent = initialResultText;
    resultDiv.style.display = 'block';
    userAnswerInput.value = '';

  </script>

</body>

</html>